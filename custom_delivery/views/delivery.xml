<odoo>
    <template id="report_delivery_document_inherit" inherit_id="stock.report_delivery_document">
        <xpath expr="//div[hasclass('page')]" position="before">
            <style>
                .avoid-page-break {
                    page-break-inside: avoid;
                }
                .header_table {
                    font-size: 14px;
                    margin-bottom: 20px;
                }
                .company_info {
                    width: 45%;
                    float: left;
                }
                .delivery_info {
                    width: 45%;
                    float: right;
                    text-align: right;
                }
                .bold_text {
                    font-weight: bold;
                }
                .table thead th {
                    background-color: grey;
                    color: black;
                    font-size: 13px;
                }
                .table tbody th {
                    font-size: 13px;
                }
                .totals-table-wrapper {
                    width: 50%;
                    float: right;
                }
                .solde {
                    font-weight: bold;
                    text-align: right;
                }
            </style>
        </xpath>

        <!-- Header Section -->
        <xpath expr="//div[hasclass('page')]" position="before">
            <div class="header_table">
                <div class="company_info">
                    <span t-field="doc.company_id.name" /><br />
                    <span t-field="doc.company_id.street" /><br />
                    <span t-field="doc.company_id.zip" /> <span t-field="doc.company_id.city" /><br />
                    <t t-if="doc.company_id.phone">
                        Tél: <span t-field="doc.company_id.phone" /><br />
                    </t>
                </div>
                <div class="delivery_info">
                    <strong class="bold_text">BON DE LIVRAISON</strong><br />
                    N°: <span t-field="doc.name" /><br />
                    <br />
                    Adresse de livraison:<br />
                    <span t-field="doc.partner_shipping_id.name" /><br />
                    <span t-field="doc.partner_shipping_id.street" /><br />
                    <span t-field="doc.partner_shipping_id.zip" />
                    <span t-field="doc.partner_shipping_id.city" /><br />
                    Contact: <span t-field="doc.user_id.name" />
                    <span t-field="doc.user_id.phone" /><br />
                </div>
            </div>
        </xpath>

        <!-- Information Section -->
        <xpath expr="//div[@id='informations']" position="replace">
            <div id="informations">
                <table>
                    <tr>
                        <td>Projet:</td>
                        <td><strong t-field="doc.origin" /></strong></td>
                    </tr>
                    <tr>
                        <td>Série:</td>
                        <td><span>Série</span></td>
                    </tr>
                    <tr>
                        <td>Finition:</td>
                        <td>RAL 7021</td>
                    </tr>
                    <tr>
                        <td>Finition accessoires:</td>
                        <td>Argent</td>
                    </tr>
                </table>
            </div>
        </xpath>

        <!-- Table Section for Products -->
        <xpath expr="//table[hasclass('o_main_table')]/thead" position="replace">
            <thead>
                <tr>
                    <th>Description</th>
                    <th>Dimensions (L x H)</th>
                    <th>Quantité</th>
                    <th class="text-right">Livraison</th>
                    <th class="text-right">Rel. Solde</th>
                </tr>
            </thead>
        </xpath>

        <!-- Product Lines -->
        <xpath expr="//tbody[hasclass('sale_tbody')]" position="replace">
            <tbody class="sale_tbody">
                <t t-foreach="doc.order_line" t-as="line">
                    <t t-if="line.product_id.name != 'Acompte' and line.product_id.name != 'Devis'">
                        <tr>
                            <td t-field="line.product_id.name" />
                            <td><span t-field="line.product_uom_qty" /> x <span t-field="line.product_uom_qty" /></td>
                            <td><span t-field="line.product_uom_qty" /></td>
                            <td class="text-right"><span t-field="line.qty_delivered" /></td>
                            <td class="text-right solde"><span t-field="line.qty_to_invoice" /></td>
                        </tr>
                    </t>
                </t>
            </tbody>
        </xpath>
        
        <!-- Totals Section -->
        <xpath expr="//div[hasclass('clearfix')]" position="replace">
            <div class="clearfix totals-table-wrapper">
                <table class="table table-sm o_main_table" style="page-break-inside: avoid;">
                    <tfoot>
                        <tr>
                            <td colspan="4" class="text-right">
                                <strong>Total HT</strong>
                            </td>
                            <td class="text-right">
                                <span t-esc="doc.amount_untaxed" /> €
                            </td>
                        </tr>
                        <tr>
                            <td colspan="4" class="text-right">
                                <strong>Total TTC</strong>
                            </td>
                            <td class="text-right">
                                <span t-esc="doc.amount_total" /> €
                            </td>
                        </tr>
                    </tfoot>
                </table>
            </div>
        </xpath>
    </template>
</odoo>

<odoo>
    <template id="report_delivery_document_inherit" inherit_id="stock.report_delivery_document">
        <xpath expr="//div[contains(@class, 'page')]" position="replace">
            <!-- Structure en deux colonnes avec du flexbox -->
            <div class="header_table" style="display: flex; justify-content: space-between; font-family: 'DejaVu Sans', sans-serif;">
                <!-- Bloc de la soci√©t√© FMA-F2M avec √©motic√¥nes -->
                <div class="company_info" style="flex: 1;">
                    <strong t-field="o.company_id.name" /><br />
                    <img src="/custom_delivery/static/src/img/lieu.png" style="height: 16px; width: 16px;" alt="lieu" />
                    <span t-field="o.company_id.street" /><br />
                    <span t-field="o.company_id.zip" /> <span t-field="o.company_id.city" /><br />
                    <img src="/custom_delivery/static/src/img/appel-telephonique.png" style="height: 16px; width: 16px;" alt="appel-telephonique" /> T√©l: <span t-field="o.company_id.phone" /><br />
                    <img src="/custom_delivery/static/src/img/enveloppe.png" style="height: 16px; width: 16px;" alt="menveloppe" /> Email: <span t-field="o.company_id.email" />
                </div>

                <!-- Bloc des informations de livraison avec √©motic√¥nes align√© √† droite -->
                <div class="delivery_info" style="flex: 1; text-align: right;">
                    <strong class="bold_text">BON DE LIVRAISON</strong><br />
                    N¬∞: 
                    <t t-if="'OUT' in o.name">
                        <t t-esc="o.name.replace('OUT', 'BL')"/>
                    </t>
                    <t t-else="">
                        <t t-esc="o.name"/>
                    </t>
                    <br />
                    <br />
                    <t t-if="o.partner_id">
                        <img src="/custom_delivery/static/src/img/camion.png" style="height: 16px; width: 16px;" alt="camion" /> Adresse de livraison :<br />
                        <span t-field="o.partner_id.name" /><br />
                        <span t-field="o.partner_id.street" /><br />
                        <span t-field="o.partner_id.zip" /> <span t-field="o.partner_id.city" /><br />
                        Contact: ‚òéÔ∏è <span t-field="o.partner_id.phone" /><br />
                        <img src="/custom_delivery/static/src/img/enveloppe.png" style="height: 16px; width: 16px;" alt="menveloppe" /> <span t-field="o.partner_id.email" />
                    </t>
                </div>

                <!-- Nouveau bloc d'information concernant le client, align√© √† droite -->
                <div class="customer_info" style="position: absolute; top: 60px; right: 20px; text-align: right; font-size: 12px;">
                    <strong t-field="o.partner_id.name" /><br />
                    <span><strong class="bold_text">Adresse:</strong> <span t-field="o.partner_id.street" /></span><br />
                    <span t-field="o.partner_id.zip" /> <span t-field="o.partner_id.city" /><br />
                </div>
            </div>

            <!-- Bloc pour les quatre champs personnalis√©s, organis√©s en deux colonnes -->
            <div class="custom_info" style="display: flex; justify-content: space-between; margin-top: 20px;">
                <!-- Colonne de gauche -->
                <div style="flex: 1; padding-right: 20px;">
                    <p><strong> Acc√®s : </strong><span t-field="o.so_acces_bl" /></p>
                    <p><strong> Type de camion : </strong><span t-field="o.so_type_camion_bl" /></p>
                </div>
                <!-- Colonne de droite -->
                <div style="flex: 1; padding-left: 20px; text-align: right;">
                    <p><strong>üïí Horaire d'ouverture : </strong><span t-field="o.so_horaire_ouverture_bl" t-options='{"widget": "float_time"}'/></p>
                    <p><strong>üïï Horaire de fermeture : </strong><span t-field="o.so_horaire_fermeture_bl" t-options='{"widget": "float_time"}'/></p>
                </div>
            </div>

            <!-- Table avec en-t√™te de colonne -->
            <table class="table table-sm" t-if="o.state!='done'" name="stock_move_table" style="margin-top: 20px;">
                <thead>
                    <tr>
                        <th>R√©f√©rence</th>
                        <th>Description</th>
                        <th>Largeur</th>
                        <th>Hauteur</th>
                        <th>Qte Command√©</th>
                        <th>Qte Livr√©</th>
                        <th>Reliquat</th>
                    </tr>
                </thead>
                <tbody>
                    <!-- Boucle √† travers les lignes de mouvement de stock -->   <!-- t-if Enl√®ve les lignes commen√ßant par A2 (lignes comprenant la nomenclature) -->
                    <tr t-foreach="o.move_ids_without_package" t-as="line" t-if="not (line.product_id.default_code.startswith('A2') or line.product_id.default_code.startswith('ECO'))">
                        <td>
                            <!-- R√©f√©rence du produit -->
                            <span t-field="line.product_id.default_code" />
                        </td>
                        <td>
                            <!-- Description -->
                            <span t-field="line.product_id.name" />
                        </td>
                        <td>
                            <!-- Dimensions (Largeur x Hauteur) -->
                            <span t-field="line.product_id.x_studio_largeur_mm" />
                        </td>
                        <td>
                            <span t-field="line.product_id.x_studio_hauteur_mm" />
                        </td>
                        <td>
                            <!-- Quantit√© -->
                            <span t-field="line.product_uom_qty" />
                        </td>
                        <td>
                            <span t-field="line.quantity_done" />
                        </td>
                        <td>
                            <!-- Diff√©rence (Quantit√© pr√©vue - Quantit√© livr√©e) -->
                            <t t-set="difference" t-value="line.product_uom_qty - line.quantity_done" />
                            <span t-esc="difference" />
                        </td>
                    </tr>
                </tbody>
            </table>

            <!-- Affichage du poids -->
            <div class="total_weight_section" 
                 style="margin-top: 40px; padding: 10px; border: 2px solid black; border-radius: 5px; font-weight: bold; text-align: center;">
                <t t-set="total_weight" t-value="sum(line.product_id.weight * line.product_uom_qty for line in o.move_ids_without_package)" />
                ‚öñÔ∏è Poids total : <span t-esc="total_weight"/> kg
            </div>
        </xpath>
    </template>
</odoo>

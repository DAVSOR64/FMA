<odoo>
  <!-- PIVOT -->
  <record id="view_kpi_delivery_pivot" model="ir.ui.view">
    <field name="name">kpi.delivery.billing.pivot</field>
    <field name="model">kpi.delivery.billing</field>
    <field name="arch" type="xml">
      <pivot string="KPI Facturation vs Livraison (planifiée)">
        <field name="sale_order_name" type="row"/>
        <field name="month_date" type="col" interval="month"/>
        <field name="iso_week" type="col"/>
        <field name="amount_invoiced" type="measure"/>
        <field name="amount_to_invoice" type="measure"/>
        <field name="order_count" type="measure"/> <!-- NEW -->
      </pivot>
    </field>
  </record>

  <!-- LISTE -->
  <record id="view_kpi_delivery_tree" model="ir.ui.view">
    <field name="name">kpi.delivery.billing.tree</field>
    <field name="model">kpi.delivery.billing</field>
    <field name="arch" type="xml">
      <tree create="false" edit="false">
        <field name="sale_order_name"/>
        <field name="scheduled_datetime"/>
        <field name="month_date"/>
        <field name="iso_year"/>
        <field name="iso_week"/>
        <field name="invoice_status"/>
        <field name="order_count"/> <!-- NEW -->
        <field name="amount_to_invoice" sum="Total"/>
        <field name="amount_invoiced" sum="Total"/>
      </tree>
    </field>
  </record>

  <!-- GRAPH -->
  <record id="view_kpi_delivery_graph" model="ir.ui.view">
    <field name="name">kpi.delivery.billing.graph</field>
    <field name="model">kpi.delivery.billing</field>
    <field name="arch" type="xml">
      <graph string="Facturé vs RAF par mois de livraison" type="bar">
        <field name="month_date" type="row" interval="month"/>
        <field name="amount_invoiced" type="measure"/>
        <field name="amount_to_invoice" type="measure"/>
        <field name="order_count" type="measure"/> <!-- NEW (utile si tu veux un graphe de volumes) -->
      </graph>
    </field>
  </record>

  <!-- SEARCH: inchangé (garde tes filtres) -->
</odoo>

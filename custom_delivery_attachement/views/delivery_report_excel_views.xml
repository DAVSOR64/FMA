<odoo>
    <!-- Ajouter le bouton "Télécharger Excel" dans la vue du bon de livraison -->
    <record id="view_picking_form_inherit" model="ir.ui.view">
        <field name="name">stock.picking.form.excel.report</field>
        <field name="model">stock.picking</field>
        <field name="inherit_id" ref="stock.view_picking_form" />
        <field name="arch" type="xml">
            <header>
                <button name="%(action_delivery_report_excel)d" string="Télécharger Excel" type="action"
                        class="oe_highlight" />
            </header>
        </field>
    </record>

    <!-- Action de rapport pour générer l'Excel -->
    <record id="action_delivery_report_excel" model="ir.actions.report">
        <field name="name">Bon de Livraison Excel</field>
        <field name="model">stock.picking</field>
        <field name="report_type">xlsx</field>
        <field name="report_name">custom_delivery_attachement.delivery_report_excel_template</field>
        <field name="report_file">custom_delivery_attachement.delivery_report_excel_template</field>
        <field name="binding_model_id" ref="stock.model_stock_picking" />
        <field name="binding_type">report</field>
    </record>
</odoo>
